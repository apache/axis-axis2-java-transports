<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements. See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership. The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License. You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied. See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->
<document>
    <properties>
        <title>JMS transport</title>
    </properties>
    <body>
        <section name="Transport configuration">
            <p>Sample axis2.xml:</p>
<pre><![CDATA[
    <transportReceiver name="jms" class="org.apache.axis2.transport.jms.JMSListener">
        <parameter name="myTopicConnectionFactory" locked="false">                      
            <parameter name="java.naming.factory.initial" locked="false">org.apache.activemq.jndi.ActiveMQInitialContextFactory</parameter>
            <parameter name="java.naming.provider.url" locked="false">tcp://localhost:61616</parameter>         
            <parameter name="transport.jms.ConnectionFactoryJNDIName" locked="false">TopicConnectionFactory</parameter>
        </parameter>
        <parameter name="myQueueConnectionFactory" locked="false">
            <parameter name="java.naming.factory.initial" locked="false">org.apache.activemq.jndi.ActiveMQInitialContextFactory</parameter>
            <parameter name="java.naming.provider.url" locked="false">tcp://localhost:61616</parameter>         
            <parameter name="transport.jms.ConnectionFactoryJNDIName" locked="false">QueueConnectionFactory</parameter>
        </parameter>
        <parameter name="default" locked="false">                       
            <parameter name="java.naming.factory.initial" locked="false">org.apache.activemq.jndi.ActiveMQInitialContextFactory</parameter>
            <parameter name="java.naming.provider.url" locked="false">tcp://localhost:61616</parameter>         
            <parameter name="transport.jms.ConnectionFactoryJNDIName" locked="false">QueueConnectionFactory</parameter>
        </parameter>
    </transportReceiver>
]]></pre>
            <p>If a connection factory named "default" (as shown above) is defined, this would be used for services which does
            not explicitly specify the connection factory that should be used. The services.xml of a service should indicate
            the connection factory and the destination name to be associated with. If a destination is not specified, the
            implementation would create a JMS Queue with the service name. The JMS destination should ideally be created
            and administered through the JMS provider utilities.</p>
        </section>
        <section name="Service configuration">
            <table class="bodyTable">
                <tr>
                    <th>Parameter</th>
                    <th>Require</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>transport.jms.ConnectionFactory</td>
                    <td>Optional</td>
                    <td>The JMS connection factory definition (from axis2.xml) to be used to
                    listen for messages for this service.</td>
                </tr>
                <tr>
                    <td>transport.jms.Destination</td>
                    <td>Optional</td>
                    <td>The JMS destination name (Defaults to a Queue with the service name).</td>
                </tr>
                <tr>
                    <td>transport.jms.DestinationType</td>
                    <td>Optional</td>
                    <td>The JMS destination type. Accept values 'queue' or 'topic' (default:
                    queue).</td>
                </tr>
                <tr>
                    <td>transport.jms.ReplyDestination</td>
                    <td>Optional</td>
                    <td>The destination where a reply will be posted.</td>
                </tr>
                <tr>
                    <td>transport.jms.ContentType</td>
                    <td>Optional</td>
                    <td>Specifies how the transport listener should determine the content type of received messages.
                    This can either be a simple string value, in which case the transport listener assumes that
                    the received messages always have the specified content type, or a set of rules as in the following example:
<pre><![CDATA[
<parameter name="transport.jms.ContentType">
    <rules>
        <jmsProperty>contentType</jmsProperty>
        <jmsProperty>ctype</jmsProperty>
        <default>text/xml</default>
    </rules>
</parameter>
]]></pre>
                    The rules are evaluated in turn until the first matches. The following rule types are defined:
                    <dl>
                        <dt>jmsProperty</dt>
                        <dd>Extract the content type from the specified message property.</dd>
                        <dt>bytesMessage</dt>
                        <dt>textMessage</dt>
                        <dd>Match the corresponding message type. The content type is specified as the value of
                        the rule, e.g. <tt><![CDATA[<bytesMessage>binary/octet-stream</bytesMessage>]]>.</tt></dd>
                        <dt>default</dt>
                        <dd>Defines the default content type. This rule always matches and should therefore
                        be the last rule in the rule set.</dd>
                    </dl>
                    If none of the rules matches, an error is triggered and the message is not processed.
                    The default value for this property corresponds to the following set of rules:
<pre><![CDATA[
<parameter name="transport.jms.ContentType">
    <rules>
        <jmsProperty>Content-Type</jmsProperty>
        <bytesMessage>application/octet-stream</bytesMessage>
        <textMessage>text/plain</textMessage>
    </rules>
</parameter>
]]></pre>
                    This choice preserves compatibility with previous versions of the JMS transport. Note however
                    that "Content-Type" is not a valid JMS property name and will not work with some JMS providers.</td>
                </tr>
                <tr>
                    <td>Wrapper</td>
                    <td>Optional</td>
                    <td>The wrapper element for pure text or binary messages. Note that this parameter is
                    actually not JMS specific but recognized by the message builders for text/plain and
                    application/octet-stream (which are the respective default content types for JMS text
                    and binary messages).</td>
                </tr>
            </table>
            <p>Sample services.xml:</p>
<pre><![CDATA[
<service name="echo">
        <transports>
                ....
            <transport>jms</transport>
        </transports>
    ...
    <parameter name="transport.jms.ConnectionFactory" locked="true">myTopicConnectionFactory</parameter>
    <parameter name="transport.jms.Destination" locked="true">dynamicTopics/something.TestTopic</parameter>
</service>
]]></pre>
        </section>
        <section name="Endpoint references">
<pre>    
jms-epr = "jms:/" jms-dest [ "?" param  *( [ "&amp;" param ] ) ]
param = param-name "=" param-value
</pre>

            <table class="bodyTable">
                <tr>
                    <th>Parameter</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>transport.jms.ConnectionFactoryJNDIName</td>
                    <td></td>
                </tr>  
                <tr>
                    <td>transport.jms.DestinationType</td>
                    <td></td>
                </tr>  
                <tr>
                    <td>transport.jms.ReplyDestination</td>
                    <td></td>
                </tr>  
                <tr>
                    <td>transport.jms.ReplyDestinationType</td>
                    <td></td>
                </tr>  
                <tr>
                    <td>java.naming.factory.initial</td>
                    <td></td>
                </tr>  
                <tr>
                    <td>java.naming.provider.url</td>
                    <td></td>
                </tr>  
                <tr>
                    <td>java.naming.security.principal</td>
                    <td></td>
                </tr>  
                <tr>
                    <td>java.naming.security.credentials</td>
                    <td></td>
                </tr>
            </table>
        </section>
    </body>
</document>